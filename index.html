<!DOCTYPE html>

<html>
    <head>
        <title>sikchat</title>
        
        <!-- UNIVERSAL -->
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/sikchat.css">

            <!-- FONTS -->
            <link href="https://fonts.googleapis.com/css2?family=Modak&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">

        <!-- GAMES -->
        <link rel="stylesheet" type="text/css" href="components/intermission/intermission.css">
        <link rel="stylesheet" type="text/css" href="components/starting/starting.css">
        
        <link rel="stylesheet" type="text/css" href="components/started/started.css">
        <link rel="stylesheet" type="text/css" href="css/clock.css">

        <link rel="stylesheet" type="text/css" href="components/ending/ending.css">
        <script src="https://use.fontawesome.com/4d7207fa33.js"></script>
    </head>
    <body>
        <input id="side-bar-toggler" type="checkbox" />
        <label class="show-side-bar" for="side-bar-toggler"><i class="fa fa-bars"></i></label>
        <div class="side-bar">
            <label for="side-bar-toggler"><i class="fa fa-caret-left"></i></label>
            moniker
            <br>
            <input id="username" name="username" type="text" autocomplete="off" spellcheck="false" maxlength="16" />
            <br>
            rooms
            <br>
            <select multiple>
                <option>history</option>
                <option>slang</option>
                <option>maps</option>
                <option>madlibs</option>
                <option>qewrty</option>
            </select>
        </div>
        <!-- <div class="tiny-header-user-name"></div> -->
        <div class="header">
            <div class="form-column">

            </div>
            <div class="spacer-column"></div>
            <div class="logo-column">
                <div class="ghost-drawer"><div class="ghost-logo">sikchat</div></div>
                <div class="drawer">
                    <div class="drawer-contents">
                        <div class="drawer-item">
                            <div>
                                <label class="username">
                                    <span class="username-lookup-success off">success! </span>
                                    <span class="in-use-username">(in use) </span>
                                    <span class="bogus-username">(bogus) </span>
                                    <span class="checking-username">checking.. </span> 
                                    moniker
                                </label> 
                            </div>
                            <div>
                                <input id="username" name="username" autocomplete="off" spellcheck="false" maxlength="16" />
                            </div>
                        </div>
                    </div>

                    <div class="drawer-handle">
                        <span id="logo">sikchat</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="chat-body">
            <div id="messages"></div>
            <div class="handler"></div>
            <div id="game-window"></div>
        </div>
        
        <div class="chat-bar">
            <form id="chat-form" class="form-column">
                <input id="message-input" name="message-input" autofocus="true" autocomplete="off" maxlength="280" /><button id="submit-button" tabindex="-1"></button>
                <div class="next-game-in-wrapper">
                    <span>next game:</span><br /><span class="next-game-in">10</span>s
                </div>
            </form>

            <div class="spacer-column"></div>
            <div class="logo-column"> sikchat </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js" integrity="sha512-APVsMirhHF2o3YdCSwYonM7egfT589pTqyoy5hIzEbs9sAGJSbEI6ssXUwngHjaq4V/GmmmpgqrcLSvsO+gsJQ==" crossorigin="anonymous"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js" integrity="sha512-v8ng/uGxkge3d1IJuEo6dJP8JViyvms0cly9pnbfRxT6/31c3dRWxIiwGnMSWwZjHKOuY3EVmijs7k1jz/9bLA==" crossorigin="anonymous"></script>
       
        <!-- <script src="js/loadGame.js"></script> -->
        <script src="js/screen.js"></script>
        <script src="js/ui.js"></script>

        <script>
            /* ------------- EXPERIMENTAL UI ------------- */
            
            // --- toggle settings mode on top of screen
            $("body").on("click", ".spacer-column", (e) => {
                console.log(e.target)
                document.body.classList.toggle("show-header")
            })
            
            var handler = document.querySelector('.handler');
            var chatBody = document.querySelector('.chat-body');
            var messages = document.getElementById('messages');
            var isHandlerDragging = false;

            // --- resizable center bar!!
            // init left window
            initDrag()

            document.addEventListener('mousedown', function(e) {
                console.log()

                // If mousedown event is fired from .handler, toggle flag to true
                if (e.target === handler) {
                    isHandlerDragging = true;
                }
            });

            document.addEventListener('mousemove', function(e) {
            // Don't do anything if dragging flag is false
                if (!isHandlerDragging) {
                    return false;
                }

            // Get offset
                var containerOffsetLeft = chatBody.offsetLeft;

                // Get x-coordinate of pointer relative to container
                var pointerRelativeXpos = e.clientX - containerOffsetLeft;

                // Resize box A
                // * 8px is the left/right spacing between .handler and its inner pseudo-element
                // * Set flex-grow to 0 to prevent it from growing
                // messages.style.width = (pointerRelativeXpos - 8) + 'px';
                messages.style.width = pointerRelativeXpos + 'px';
                messages.style.flexGrow = 0;
            });

            document.addEventListener('mouseup', function(e) {
                // Turn off dragging flag when user mouse is up
                isHandlerDragging = false;
            });

            window.addEventListener("resize", () => {
                if(messages.style.flexGrow == 0) {
                    messages.style.flex = "1 1 0"
                    messages.style.width = "auto"
                }
            })

            var resizeId;
            window.addEventListener('resize', function() {
                clearTimeout(resizeId);
                resizeId = setTimeout(initDrag, 500)
            })

            function initDrag() {
                messages.style.width = messages.offsetWidth + "px"
                messages.style.flex = "0 1 auto"
            }
        </script>
    </body>
</html>